
<!-- README.md is generated from README.Rmd. Please edit that file -->

# phytoclass

The *phytoclass* package uses non-negative matrix factorization and
simulated annealing to determine the biomass of different phytoplankton
groups from pigment concentrations.

## Installation

It can be installed from CRAN with:

``` r
install.packages("phytoclass")
```

Or the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("AndyMcKenzieFromNZ/phytoclass")
```

## Example

For the built-in samples matrix Sm of pigment samples:

``` r
library(phytoclass)
Results <- simulated_annealing(Sm, niter = 5)
#> 
#> Condition number = 382
#> Current error:  0.0284
#> Neighbour's error:  0.0284
#> Temperature (%):  99.1
#> [1] " "
#> Current error:  0.0243
#> Neighbour's error:  0.0243
#> Temperature (%):  98.21
#> [1] " "
#> Current error:  0.0243
#> Neighbour's error:  0.0248
#> Temperature (%):  97.32
#> [1] " "
#> Current error:  0.0243
#> Neighbour's error:  0.0263
#> Temperature (%):  96.45
#> [1] " "
#> Current error:  0.0242
#> Neighbour's error:  0.0242
#> Temperature (%):  95.58
#> [1] " "

Results$RMSE
#> [1] 0.02415171
Results$MAE
#>          Per       X19but         Fuco         Neox          Pra         Viol 
#> 4.796815e-03 3.561784e-05 5.095640e-04 1.219304e-02 2.404575e-03 2.268146e-02 
#>       X19hex         Allo          Zea        Chl.b        Tchla 
#> 1.880305e-04 4.545206e-04 2.643913e-03 2.896100e-03 3.534449e-03
Results$Error
#>                 Per        X19but          Fuco          Neox           Pra
#> 1257  -1.544651e-04  3.927510e-05 -4.356794e-03 -1.169614e-03 -1.328980e-03
#> 1278  -5.093960e-04  1.295216e-04 -1.436786e-02 -7.149551e-04  5.584500e-04
#> 1908  -4.659203e-04  1.184673e-04 -1.314160e-02  2.290448e-03 -1.268125e-03
#> 1909  -4.251160e-04  1.080922e-04 -1.199069e-02  2.352000e-03 -1.360577e-03
#> 1914  -1.585610e-04  4.031652e-05 -4.472319e-03  5.504866e-03 -2.203286e-03
#> 1915  -1.047737e-04  2.664031e-05 -2.955214e-03  5.319587e-03 -2.185928e-03
#> 5614   0.000000e+00 -4.662745e-05  5.172392e-03  3.245674e-03 -1.515023e-03
#> 5647   0.000000e+00 -3.270481e-05  3.627950e-03  1.820278e-03  1.354459e-03
#> 5653  -2.201589e-06  5.597872e-07 -6.209731e-05  1.592803e-03  5.197193e-04
#> 6770   0.000000e+00 -5.418843e-05  6.011133e-03  3.025347e-03 -1.937302e-03
#> 8425   0.000000e+00 -1.326221e-05  1.471179e-03  2.797530e-03 -3.155545e-03
#> 8426   0.000000e+00 -1.706336e-05  1.892841e-03  1.084810e-02 -4.659372e-03
#> 9538   0.000000e+00 -1.065116e-05  1.181535e-03  7.931998e-03 -5.376226e-03
#> 9568   0.000000e+00 -2.069669e-05  2.295888e-03  7.325765e-03 -1.355311e-03
#> 9625  -4.196490e-05  1.067021e-05 -1.183649e-03  9.036506e-03  3.008990e-04
#> 9626   0.000000e+00 -6.727990e-06  7.463372e-04  5.508687e-03  6.266014e-04
#> 9838   0.000000e+00 -1.270642e-05  1.409526e-03  2.100617e-03  2.815752e-05
#> 9839   0.000000e+00 -1.689287e-05  1.873929e-03  3.038011e-03  5.714056e-04
#> 9845   0.000000e+00 -6.567531e-06  7.285375e-04  2.295987e-03 -1.344619e-03
#> 9860   0.000000e+00 -2.822735e-05  3.131265e-03 -5.352300e-04 -2.114022e-03
#> 9861  -8.217625e-06  2.089455e-06 -2.317837e-04  2.614351e-04 -9.337996e-04
#> 9904   0.000000e+00 -3.847423e-06  4.267953e-04 -6.503266e-05 -1.289971e-03
#> 9913  -1.354328e-05  3.443584e-06 -3.819975e-04  2.642207e-03 -1.477812e-03
#> 9938   0.000000e+00 -5.963878e-05  6.615742e-03  1.199030e-02 -1.616208e-03
#> 9980   0.000000e+00 -3.717234e-05  4.123535e-03  3.135975e-03 -2.166576e-03
#> 10081 -4.682088e-06  1.190492e-06 -1.320615e-04  2.810656e-03  1.788723e-03
#> 10082  0.000000e+00 -7.724729e-06  8.569057e-04  7.068776e-03 -2.835698e-04
#> 10089  0.000000e+00 -1.839660e-05  2.040738e-03  5.480830e-03  1.637031e-04
#> 10121  0.000000e+00 -4.528583e-05  5.023566e-03  6.829974e-03 -4.741634e-03
#>                Viol        X19hex          Allo           Zea         Chl.b
#> 1257  -7.761415e-03 -3.596882e-04 -1.442094e-04 -6.208890e-03  0.0148542626
#> 1278  -4.371178e-03 -1.186182e-03 -4.755747e-04 -2.857442e-04  0.0010025729
#> 1908  -9.044466e-03 -1.084944e-03 -4.349856e-04 -8.429706e-04  0.0083271810
#> 1909  -8.922394e-03 -9.899271e-04 -3.968905e-04 -1.125358e-03  0.0087870322
#> 1914  -7.547257e-03 -3.692258e-04 -1.480333e-04 -8.894432e-05  0.0079543811
#> 1915  -7.186106e-03 -2.439766e-04 -9.781730e-05 -1.110613e-03  0.0086787336
#> 5614  -2.965184e-03  4.270224e-04  1.712057e-04 -3.911996e-03  0.0078712741
#> 5647  -1.262510e-03  2.995163e-04  1.200848e-04  7.215173e-05 -0.0029476004
#> 5653   8.389838e-04 -5.126630e-06 -2.055415e-06 -1.234975e-06 -0.0031239588
#> 6770  -2.871713e-03  4.962672e-04  1.989679e-04  1.195478e-04  0.0062210060
#> 8425  -8.532944e-03  1.214576e-04  4.869589e-05  2.925843e-05  0.0138589004
#> 8426  -1.141610e-02  1.562692e-04  0.000000e+00  3.764433e-05  0.0148600425
#> 9538  -1.447409e-02  9.754518e-05  0.000000e+00  2.349806e-05  0.0212476942
#> 9568  -5.918786e-03  1.895439e-04  7.599367e-05  4.566002e-05  0.0041089159
#> 9625   2.180921e-03 -9.771967e-05 -3.917865e-05 -2.354009e-05 -0.0089300771
#> 9626   1.994700e-03  6.161611e-05  2.470369e-05 -4.805040e-03 -0.0034783273
#> 9838   1.964039e-04  1.163677e-04  4.665517e-05 -3.227614e-03  0.0008813737
#> 9839  -4.439041e-03  1.547079e-04  6.202688e-05  3.726822e-05  0.0007955338
#> 9845  -3.882632e-03  6.014660e-05  2.411452e-05 -1.844245e-03  0.0067364616
#> 9860  -5.294443e-03  2.585110e-04  1.036446e-04  6.227379e-05  0.0108204387
#> 9861  -3.413017e-03 -1.913560e-05 -7.672016e-06 -1.863678e-03  0.0065201627
#> 9904  -3.794224e-03  3.523537e-05  1.412688e-05  8.487994e-06  0.0067258133
#> 9913  -4.181826e-03 -3.153695e-05 -1.264408e-05 -7.597066e-06  0.0056146188
#> 9938   9.745775e-05  5.461824e-04  2.189804e-04  1.315721e-04 -0.0031691430
#> 9980  -4.335085e-03  3.404309e-04  1.364886e-04  8.200779e-05  0.0077683942
#> 10081 -3.703905e-03 -1.090273e-05 -4.371221e-06 -2.626404e-06 -0.0030250127
#> 10082 -7.863930e-04  7.074442e-05  2.836349e-05  1.704192e-05 -0.0032028399
#> 10089  2.406832e-03  1.684793e-04  6.754823e-05  4.058567e-05 -0.0059569981
#> 10121 -1.114982e-02  4.147356e-04  1.662795e-04  9.990737e-05  0.0179567649
#>               Tchla
#> 1257   0.0668540560
#> 1278   0.2204716838
#> 1908   0.2016549764
#> 1909   0.1839944641
#> 1914   0.0686267687
#> 1915   0.0453471235
#> 5614  -0.0793692317
#> 5647  -0.0556701098
#> 5653   0.0009528696
#> 6770  -0.0922395325
#> 8425  -0.0225749256
#> 8426  -0.0290452378
#> 9538  -0.0181303985
#> 9568  -0.0352299042
#> 9625   0.0181628301
#> 9626  -0.0114523824
#> 9838  -0.0216288705
#> 9839  -0.0287550404
#> 9845  -0.0111792493
#> 9860  -0.0480485854
#> 9861   0.0035566701
#> 9904  -0.0065490817
#> 9913   0.0058616680
#> 9938  -0.1015171178
#> 9980  -0.0632747532
#> 10081  0.0020264543
#> 10082 -0.0131490313
#> 10089 -0.0313146826
#> 10121 -0.0770855296
Results$`F matrix`
#>                      Per X19but   Fuco   Neox    Pra       Viol X19hex   Allo
#> Prasinophytes     0.0000 0.0000 0.0000 0.0739 0.2746 0.09915809 0.0000 0.0000
#> Chlorophytes      0.0000 0.0000 0.0000 0.0180 0.0000 0.06000000 0.0000 0.0000
#> Cryptophytes      0.0000 0.0000 0.0000 0.0000 0.0000 0.00000000 0.0000 0.5151
#> Diatoms-B         0.0000 0.0000 0.8677 0.0000 0.0000 0.00000000 0.0000 0.0000
#> Dinoflagellates-A 0.4809 0.0000 0.0000 0.0000 0.0000 0.00000000 0.0000 0.0000
#> Haptophytes       0.0000 0.1062 0.0479 0.0000 0.0000 0.00000000 0.5266 0.0000
#> Pelagophytes      0.0000 0.7326 1.2038 0.0000 0.0000 0.00000000 0.0000 0.0000
#> Syn               0.0000 0.0000 0.0000 0.0000 0.0000 0.00000000 0.0000 0.0000
#>                      Zea  Chl.b Tchla
#> Prasinophytes     0.0792 0.7766     1
#> Chlorophytes      0.0175 0.2470     1
#> Cryptophytes      0.0000 0.0000     1
#> Diatoms-B         0.0000 0.0000     1
#> Dinoflagellates-A 0.0000 0.0000     1
#> Haptophytes       0.0000 0.0000     1
#> Pelagophytes      0.0000 0.0000     1
#> Syn               0.8573 0.0000     1
Results$`Class abudances`
#> NULL
Results$Figure
```

<img src="man/figures/README-example-1.png" width="100%" />
